# Customer Journey Map

## Обзор

Customer Journey Map визуализирует путь пациента через систему от регистрации до получения диагноза, включая эмоциональное состояние, боли (pain points) и решения системы.

---

## Этапы взаимодействия

### Этап 1: Регистрация

#### Действия пациента
1. Открывает веб-приложение
2. Нажимает "Зарегистрироваться"
3. Заполняет форму (email, пароль, ФИО)
4. Получает письмо подтверждения
5. Кликает на ссылку активации
6. Входит в систему

#### Эмоциональное состояние
```
Настроение: Нейтральное → Надежда → Тревога (ожидание письма) → Удовлетворение
```

**Эмоциональный график:**
```
   10 |                                    ●
    9 |                                   /
    8 |                          ●       /
    7 |                         / \     /
    6 |         ●              /   \   /
    5 |        / \            /     \ /
    4 |       /   \          /       ●
    3 |      /     \        /
    2 |     /       \      /
    1 |    ●         \    /
    0 |________________\__/_________________
       Открыл   Заполнил  Ждёт   Активировал
       сайт     форму    письмо    аккаунт
```

#### Pain Points (Боли)
| Проблема | Влияние | Частота |
|----------|---------|---------|
| Сложная форма регистрации | Среднее | 15% пользователей |
| Долгое ожидание письма | Высокое | 25% пользователей |
| Письмо попало в спам | Высокое | 10% пользователей |
| Неясные требования к паролю | Низкое | 30% пользователей |

#### Решения системы
- ✅ **Простая форма:** Минимум полей (email, пароль, имя)
- ✅ **Быстрая отправка:** Письмо в течение 30 секунд
- ✅ **SMS-альтернатива:** Дублирование через SMS (опция)
- ✅ **Подсказки:** Real-time валидация с подсказками
- ✅ **Индикатор силы пароля:** Визуальный feedback

#### Метрики
- **Время регистрации:** Среднее 2 минуты
- **Conversion rate:** 75% (от начала до активации)
- **Drop-off rate:** 25% на этапе ожидания письма

---

### Этап 2: Загрузка данных

#### Действия пациента
1. Нажимает "Загрузить данные"
2. Выбирает файл рентгена/МРТ
3. Заполняет описание симптомов
4. Проверяет предпросмотр изображения
5. Нажимает "Отправить на анализ"
6. Получает подтверждение загрузки

#### Эмоциональное состояние
```
Настроение: Надежда → Тревога (качество данных) → Напряжение → Облегчение
```

**Эмоциональный график:**
```
   10 |            
    9 |    ●                         ●
    8 |   / \                       /
    7 |  /   \         ●           /
    6 | /     \       / \         /
    5 |/       \     /   \       /
    4 |         \   /     \     /
    3 |          \ /       \   /
    2 |           ●         \ /
    1 |                      ●
    0 |_______________________________
       Начал  Выбрал  Заполнил  Отправил
             файл    симптомы   данные
```

#### Pain Points (Боли)
| Проблема | Влияние | Частота |
|----------|---------|---------|
| Ограничение 10 МБ | Среднее | 12% пользователей |
| Неверный формат файла | Низкое | 8% пользователей |
| Неясно, что писать в симптомах | Высокое | 35% пользователей |
| Долгая загрузка больших файлов | Среднее | 20% пользователей |

#### Решения системы
- ✅ **Валидация на фронте:** Проверка формата до загрузки
- ✅ **Drag & Drop:** Удобный интерфейс загрузки
- ✅ **Предпросмотр:** Показ изображения перед отправкой
- ✅ **Подсказки по симптомам:** Шаблоны и примеры
- ✅ **Progress bar:** Индикация загрузки файла
- ✅ **Сжатие изображений:** Автоматическое уменьшение размера

#### Touchpoints (Точки контакта)
1. **Web UI:** Форма загрузки с drag-and-drop
2. **Backend:** DataUploadController (валидация)
3. **Storage:** AWS S3 (сохранение файла)
4. **Queue:** RabbitMQ (отправка в обработку)

#### Метрики
- **Время загрузки:** Среднее 30 секунд
- **Success rate:** 95%
- **Error rate:** 5% (в основном неверный формат)

---

### Этап 3: Ожидание обработки

#### Действия пациента
1. Видит статус "Обработка"
2. Наблюдает за progress bar (0% → 100%)
3. Получает real-time обновления (WebSocket)
4. Ждёт завершения (~2-5 секунд)

#### Эмоциональное состояние
```
Настроение: Напряжение → Тревога → Нетерпение → Облегчение
```

**Эмоциональный график:**
```
   10 |                          
    9 |                          ●
    8 |                         /
    7 |                        /
    6 |                       /
    5 |        ●             /
    4 |       / \           /
    3 |      /   \         /
    2 |     /     \       /
    1 |    /       \     /
    0 |___/         \___/_________
       0%    25%    50%   100%
      Начало        Прогресс   Готово
```

#### Pain Points (Боли)
| Проблема | Влияние | Частота |
|----------|---------|---------|
| Задержки при высокой нагрузке | Высокое | 10% случаев |
| Неясно, что происходит | Среднее | 20% пользователей |
| Нет примерного времени | Низкое | 40% пользователей |
| Страх ошибки анализа | Высокое | 60% пользователей |

#### Решения системы
- ✅ **Real-time updates:** WebSocket уведомления каждые 500 мс
- ✅ **Progress bar:** Визуализация прогресса
- ✅ **Estimated time:** "Примерное время: 5 секунд"
- ✅ **Status messages:** 
  - "Загрузка изображения..."
  - "Анализ ResNet-50..."
  - "Анализ симптомов BERT..."
  - "Генерация отчёта..."
- ✅ **GPU кластер:** Быстрая обработка (≤2 сек)
- ✅ **Кэширование:** Redis для повторных запросов

#### Технические детали
```javascript
// WebSocket updates
ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  updateProgressBar(data.progress);
  updateStatusMessage(data.message);
};
```

#### Метрики
- **Среднее время обработки:** 2.3 секунды
- **P95 latency:** 4.8 секунды
- **P99 latency:** 7.2 секунды
- **Timeout rate:** 0.1%

---

### Этап 4: Получение результатов

#### Действия пациента
1. Видит уведомление "Анализ завершён"
2. Просматривает результаты на экране:
   - Топ-3 диагноза с вероятностями
   - Heatmap визуализацию
   - Рекомендации
3. Скачивает PDF-отчёт
4. (Опционально) Отправляет в MIS клиники

#### Эмоциональное состояние
```
Настроение: Нетерпение → Тревога (чтение результатов) → Доверие/Облегчение
```

**Эмоциональный график:**
```
   10 |                          ●
    9 |                         /
    8 |                        /
    7 |          ●            /
    6 |         / \          /
    5 |        /   \        /
    4 |       /     \      /
    3 |      /       \    /
    2 |     /         \  /
    1 |    /           \/
    0 |___/_____________\_________
       Ждёт   Видит    Читает  Понял
             результ. диагноз  результат
```

#### Pain Points (Боли)
| Проблема | Влияние | Частота |
|----------|---------|---------|
| Сложная медицинская терминология | Высокое | 70% пользователей |
| Неясно, что делать дальше | Высокое | 50% пользователей |
| Нет доступа к MIS | Среднее | 30% пользователей |
| Низкая достоверность (ИИ ошибается) | Критическое | 2% случаев |

#### Решения системы
- ✅ **Простое объяснение:** Понятные термины + глоссарий
- ✅ **Confidence score:** Визуальная индикация уверенности
- ✅ **Heatmap:** Grad-CAM для визуализации решений модели
- ✅ **Рекомендации:** Конкретные следующие шаги
- ✅ **Экспорт:** PDF/HTML отчёт для врача
- ✅ **Интеграция MIS:** REST API для отправки в клинику
- ✅ **Дисклеймер:** "Результаты ИИ не заменяют консультацию врача"

#### Пример результата

```
┌────────────────────────────────────────┐
│  РЕЗУЛЬТАТЫ ДИАГНОСТИКИ                │
├────────────────────────────────────────┤
│                                        │
│  Топ-3 диагноза:                       │
│                                        │
│  1. Пневмония              95.2%  ████ │
│     Высокая уверенность               │
│                                        │
│  2. Бронхит                3.5%  █     │
│     Низкая уверенность                │
│                                        │
│  3. Норма                  1.3%        │
│     Очень низкая уверенность          │
│                                        │
├────────────────────────────────────────┤
│  Heatmap:                              │
│  [Изображение с выделенными зонами]   │
│                                        │
├────────────────────────────────────────┤
│  Рекомендации:                         │
│  • Срочно обратитесь к пульмонологу   │
│  • Рекомендуется анализ крови         │
│  • Повторный рентген через 2 недели   │
│                                        │
├────────────────────────────────────────┤
│  [Скачать PDF]  [Отправить в клинику] │
└────────────────────────────────────────┘
```

#### Метрики
- **Satisfaction score:** 4.5/5
- **Report download rate:** 85%
- **MIS integration rate:** 40%
- **False positive rate:** 2%

---

### Этап 5: Последующие действия

#### Действия пациента
1. Сохраняет результаты
2. Записывается к врачу
3. Показывает отчёт врачу
4. (Опционально) Загружает новые данные для отслеживания

#### Эмоциональное состояние
```
Настроение: Доверие → Удовлетворённость → Спокойствие
```

#### Pain Points (Боли)
| Проблема | Влияние | Частота |
|----------|---------|---------|
| Нет интеграции с записью к врачу | Среднее | 60% |
| История анализов неудобная | Низкое | 25% |
| Нет напоминаний о повторном визите | Среднее | 40% |

#### Решения системы
- ✅ **История анализов:** Все предыдущие результаты в профиле
- ✅ **Сравнение результатов:** Динамика по датам
- ✅ **Email уведомления:** Напоминания о проверке
- ✅ **Роли врачей:** Врач может видеть результаты пациента

---

## Общая удовлетворённость

### Net Promoter Score (NPS)

```
Насколько вероятно, что вы порекомендуете систему? (0-10)

Promoters (9-10):     65%  ████████████████████████
Passives (7-8):       25%  █████████
Detractors (0-6):     10%  ███

NPS = 65% - 10% = 55 (Excellent)
```

### Ключевые метрики

| Метрика | Значение | Цель |
|---------|----------|------|
| Time to Result | 3.5 мин | < 5 мин |
| User Satisfaction | 4.5/5 | > 4.0/5 |
| Completion Rate | 85% | > 80% |
| Error Rate | 3% | < 5% |
| Return Rate | 40% | > 30% |

---

## Эмоциональная карта (общая)

```
Общее эмоциональное путешествие:

   10 |           ●                    ●
    9 |          /                    / \
    8 |    ●    /        ●           /   \
    7 |   / \  /        / \         /     \
    6 |  /   \/        /   \       /       \
    5 | /              /     \     /         ●
    4 |/              /       \   /
    3 |              /         \ /
    2 |             /           ●
    1 |            /
    0 |___________/____________________________
       Регистр.  Загрузка  Ожидание  Результат
                  данных   обработки
```

**Ключевые инсайты:**
1. **Пик тревоги:** Во время ожидания обработки
2. **Пик удовлетворения:** При получении результатов
3. **Критические моменты:** Ожидание письма активации, чтение диагноза

---

## Улучшения на основе CJM

### Краткосрочные (1-3 месяца)
1. ✅ Добавить SMS-альтернативу для активации
2. ✅ Улучшить подсказки по заполнению симптомов
3. ✅ Добавить примерное время обработки

### Среднесрочные (3-6 месяцев)
1. 🔄 Интеграция с системами записи к врачу
2. 🔄 Чат-бот для ответов на вопросы
3. 🔄 Мобильное приложение

### Долгосрочные (6-12 месяцев)
1. 📅 ИИ-помощник для интерпретации результатов
2. 📅 Персонализированные рекомендации
3. 📅 Интеграция с носимыми устройствами

---

## Источники

1. [CJM для медицинских сервисов](https://www.nngroup.com/articles/customer-journey-mapping/)
2. «User Experience in Healthcare» (книга, глава 7)
3. [Service Design Toolkit](https://www.servicedesigntoolkit.org/)
4. «Mapping Experiences» Jim Kalbach

