# UML Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹: Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

## Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ 2: Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¼ĞµĞ´Ğ¸Ñ†Ğ¸Ğ½ÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### 1. Use Case Diagram (Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ² Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)

```mermaid
graph TB
    subgraph "Actors"
        Patient[ğŸ‘¤ ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚]
        StorageSystem[ğŸ’¾ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ]
    end
    
    subgraph "Use Cases"
        UploadImage[Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹]
        UploadSymptoms[Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ ÑĞ¸Ğ¼Ğ¿Ñ‚Ğ¾Ğ¼Ğ¾Ğ²]
        ValidateFiles[Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²]
        PreviewImage[ĞŸÑ€ĞµĞ´Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ]
    end
    
    Patient --> UploadImage
    Patient --> UploadSymptoms
    UploadImage --> ValidateFiles
    UploadSymptoms --> ValidateFiles
    PreviewImage -.->|extends| UploadImage
    StorageSystem --> UploadImage
    StorageSystem --> UploadSymptoms
    
    style Patient fill:#67c23a,stroke:#4a9428,stroke-width:2px
    style StorageSystem fill:#e6a23c,stroke:#b8821e,stroke-width:2px
    style UploadImage fill:#4a90e2,stroke:#2e5c8a,stroke-width:2px,color:#fff
    style UploadSymptoms fill:#4a90e2,stroke:#2e5c8a,stroke-width:2px,color:#fff
    style ValidateFiles fill:#9966ff,stroke:#7744cc,stroke-width:2px,color:#fff
    style PreviewImage fill:#4a90e2,stroke:#2e5c8a,stroke-width:2px,color:#fff
```

**ĞĞºÑ‚Ñ‘Ñ€Ñ‹:**
- **ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚** (Patient)
- **Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ** (Storage System)

**Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
1. **Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹**
   - ĞŸĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ°ĞºÑ‚Ñ‘Ñ€: ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚
   - ĞŸÑ€ĞµĞ´ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ: ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
   - ĞŸĞ¾ÑÑ‚ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ: Ğ˜Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾ Ğ² S3
   
2. **Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ ÑĞ¸Ğ¼Ğ¿Ñ‚Ğ¾Ğ¼Ğ¾Ğ²**
   - ĞŸĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ°ĞºÑ‚Ñ‘Ñ€: ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚
   - ĞŸÑ€ĞµĞ´ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ: ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
   - ĞŸĞ¾ÑÑ‚ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ: Ğ¢ĞµĞºÑÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½, Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
   
3. **Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²**
   - ĞŸĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ°ĞºÑ‚Ñ‘Ñ€: Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ°
   - Ğ¡Ğ²ÑĞ·ÑŒ: `<<include>>` Ğ´Ğ»Ñ Ğ¾Ğ±Ğ¾Ğ¸Ñ… ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸ĞµĞ² Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

**Ğ¡Ğ²ÑĞ·Ğ¸:**
- `<<include>>`: Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
- `<<extend>>`: ĞŸÑ€ĞµĞ´Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ€Ğ°ÑÑˆĞ¸Ñ€ÑĞµÑ‚ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ

---

### 2. Activity Diagram (Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ĞµĞ¹)

```
[ĞĞ°Ñ‡Ğ°Ğ»Ğ¾]
    â†“
[ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ñ„Ğ°Ğ¹Ğ»]
    â†“
<Ğ¢Ğ¸Ğ¿ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…?> â—‡
    â”œâ”€ Ğ˜Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ â†’ [Validate image format]
    â””â”€ Ğ¢ĞµĞºÑÑ‚ â†’ [Validate JSON structure]
    â†“
<Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚ĞµĞ½?> â—‡
    â”œâ”€ ĞĞµÑ‚ â†’ [ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°] â†’ [ĞšĞ¾Ğ½ĞµÑ†]
    â””â”€ Ğ”Ğ° â†“
[ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ°]
    â†“
<Ğ Ğ°Ğ·Ğ¼ĞµÑ€ â‰¤ 10 ĞœĞ‘?> â—‡
    â”œâ”€ ĞĞµÑ‚ â†’ [ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°] â†’ [ĞšĞ¾Ğ½ĞµÑ†]
    â””â”€ Ğ”Ğ° â†“
[Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ID]
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â•‘ ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ â•‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â•‘                          â•‘
    â•‘ [Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² S3]        â•‘ [Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² PostgreSQL]
    â•‘         â†“                â•‘          â†“
    â•‘ [Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ URL]          â•‘ [Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ: user_id, file_id, timestamp]
    â•‘                          â•‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“ Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
[Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ RabbitMQ]
    â†“
[ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ medical_data]
    â†“
[Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ task_id Ğ¿Ğ°Ñ†Ğ¸ĞµĞ½Ñ‚Ñƒ]
    â†“
[ĞšĞ¾Ğ½ĞµÑ†]
```

**ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸:**
- Fork: Ğ Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¸
- Join: Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ²

---

### 3. Sequence Diagram (Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸)

**Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸:**
- Patient (ĞŸĞ°Ñ†Ğ¸ĞµĞ½Ñ‚)
- WebUI (React)
- APIGateway (Spring Cloud)
- DataUploadController
- FileValidator
- S3Client
- PostgreSQL
- RabbitMQ

```
Patient  WebUI  APIGateway  DataUploadController  FileValidator  S3Client  PostgreSQL  RabbitMQ
  |        |         |              |                   |          |           |          |
  |--Select file---->|              |                   |          |           |          |
  |        |         |              |                   |          |           |          |
  |        |--POST /upload--------->|                   |          |           |          |
  |        |  (multipart/form-data) |                   |          |           |          |
  |        |         |              |                   |          |           |          |
  |        |         |              |---validate(file)------------>|           |          |
  |        |         |              |                   |          |           |          |
  |        |         |              |                   |--checkFormat()       |          |
  |        |         |              |                   |<--OK----|           |          |
  |        |         |              |                   |          |           |          |
  |        |         |              |                   |--checkSize()         |          |
  |        |         |              |                   |<--OK----|           |          |
  |        |         |              |<---ValidationResult|          |           |          |
  |        |         |              |                   |          |           |          |
  |        |         |     [Generate unique fileId]     |          |           |          |
  |        |         |              |                   |          |           |          |
  |        |         |              |---upload(file, fileId)------>|           |          |
  |        |         |              |                   |          |--PUT---->|          |
  |        |         |              |                   |          |<--OK-----|          |
  |        |         |              |<---S3 URL---------|          |           |          |
  |        |         |              |                   |          |           |          |
  |        |         |              |---saveMetadata(fileId, url)------------>|          |
  |        |         |              |                   |          |  INSERT  |          |
  |        |         |              |<---OK-------------|          |<---------|          |
  |        |         |              |                   |          |           |          |
  |        |         |              |---sendMessage(fileId, url)----------------------->|
  |        |         |              |                   |          |           |  AMQP   |
  |        |         |              |<---OK-------------|          |           |---------|
  |        |         |              |                   |          |           |          |
  |        |         |<---202 Accepted------------------|          |           |          |
  |        |         |   {taskId: "abc123"}             |          |           |          |
  |<-------|         |              |                   |          |           |          |
  |        |         |              |                   |          |           |          |
[Display: "Processing..."]         |                   |          |           |          |
```

---

### 4. Class Diagram (Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ĞºĞ»Ğ°ÑÑĞ¾Ğ²)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DataUploadController          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - uploadService: UploadService  â”‚
â”‚ - validator: FileValidator      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + uploadFile(file): Response    â”‚
â”‚ + getUploadStatus(id): Status   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ uses
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      UploadService              â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚     FileValidator           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - s3Client: S3Client            â”‚         â”‚ - allowedFormats: List      â”‚
â”‚ - metadataRepo: MetadataRepo    â”‚         â”‚ - maxSize: Long             â”‚
â”‚ - messageProducer: RabbitMQ     â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚ + validateFormat(file): boolâ”‚
â”‚ + processUpload(file): TaskId   â”‚         â”‚ + validateSize(file): bool  â”‚
â”‚ + saveFile(file): String        â”‚         â”‚ + validate(file): Result    â”‚
â”‚ + saveMetadata(data): void      â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ + sendToQueue(message): void    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ uses
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       S3Client                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - bucket: String                â”‚
â”‚ - region: String                â”‚
â”‚ - credentials: AWSCredentials   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + upload(file, key): URL        â”‚
â”‚ + generatePresignedUrl(key): URLâ”‚
â”‚ + deleteFile(key): void         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     FileMetadata                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - id: UUID                      â”‚
â”‚ - userId: Long                  â”‚
â”‚ - fileName: String              â”‚
â”‚ - fileType: FileType            â”‚
â”‚ - s3Url: String                 â”‚
â”‚ - fileSize: Long                â”‚
â”‚ - uploadedAt: Timestamp         â”‚
â”‚ - status: UploadStatus          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + getId(): UUID                 â”‚
â”‚ + getS3Url(): String            â”‚
â”‚ + updateStatus(status): void    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–³
           â”‚ persists
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MetadataRepository            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ <<interface>>                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + save(metadata): FileMetadata  â”‚
â”‚ + findById(id): FileMetadata    â”‚
â”‚ + findByUserId(userId): List    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RabbitMQProducer              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - template: RabbitTemplate      â”‚
â”‚ - exchange: String              â”‚
â”‚ - routingKey: String            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + send(message): void           â”‚
â”‚ + sendWithRetry(message): void  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   <<enumeration>>               â”‚
â”‚      FileType                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IMAGE_JPEG                      â”‚
â”‚ IMAGE_PNG                       â”‚
â”‚ TEXT_JSON                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   <<enumeration>>               â”‚
â”‚    UploadStatus                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UPLOADING                       â”‚
â”‚ UPLOADED                        â”‚
â”‚ PROCESSING                      â”‚
â”‚ COMPLETED                       â”‚
â”‚ FAILED                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5. State Diagram (Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹)

**ĞĞ±ÑŠĞµĞºÑ‚:** File Upload

```
             [User uploads file]
                     â†“
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â—â”€â”€â”€â”€>â”‚ Validatingâ”‚
               â”‚(Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ)â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ validation passed
                     â†“
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ Uploadingâ”‚
               â”‚(Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°)â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
                â”‚    â”‚    â”‚
     error      â”‚    â”‚    â”‚ success
         â”Œâ”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”
         â”‚           â”‚           â”‚
         â†“           â†“           â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Failed  â”‚ â”‚ Uploaded â”‚ â”‚ InQueue  â”‚
   â”‚(ĞÑˆĞ¸Ğ±ĞºĞ°)  â”‚ â”‚(Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½)â”‚ â”‚(Ğ’ Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸)â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚           â”‚           â”‚
         â”‚ retry     â”‚           â”‚ message consumed
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â†“
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚Processingâ”‚
                           â”‚(ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°)â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                            â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
                            â”‚    â”‚    â”‚
                  error     â”‚    â”‚    â”‚ success
                      â”Œâ”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”
                      â”‚          â”‚          â”‚
                      â†“          â†“          â†“
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Failed   â”‚ â”‚Completed â”‚ â”‚ Archived â”‚
                â”‚(ĞÑˆĞ¸Ğ±ĞºĞ°)  â”‚ â”‚(Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾)  â”‚ â”‚(ĞÑ€Ñ…Ğ¸Ğ²)   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚          â”‚ after 30 daysâ”‚
                      â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ admin deletes
                      â†“
                      â—
```

**Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ:**
1. **Validating:** ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° Ğ¸ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ°
2. **Uploading:** Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ² S3
3. **Uploaded:** Ğ¤Ğ°Ğ¹Ğ» ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½ Ğ² S3
4. **InQueue:** Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ² RabbitMQ
5. **Processing:** ML Service Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚
6. **Completed:** ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°
7. **Failed:** ĞÑˆĞ¸Ğ±ĞºĞ° Ğ½Ğ° Ğ»ÑĞ±Ğ¾Ğ¼ ÑÑ‚Ğ°Ğ¿Ğµ
8. **Archived:** ĞŸĞµÑ€ĞµĞ¼ĞµÑ‰Ñ‘Ğ½ Ğ² Ğ´Ğ¾Ğ»Ğ³Ğ¾ÑÑ€Ğ¾Ñ‡Ğ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ

---

### 6. Component Diagram (Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Data Upload Module                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                      â”‚         â”‚                  â”‚     â”‚
â”‚  â”‚ DataUploadController â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  UploadService   â”‚     â”‚
â”‚  â”‚                      â”‚ <<uses>>â”‚                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚                                â”‚                â”‚
â”‚           â”‚ exposes                        â”‚ uses           â”‚
â”‚           â†“                                â†“                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   REST API       â”‚           â”‚  FileValidator   â”‚       â”‚
â”‚  â”‚  POST /upload    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                        â”‚
                    â”‚ uses                   â”‚ uses
                    â†“                        â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                        â”‚   â”‚                     â”‚
     â”‚   AWS S3 Client        â”‚   â”‚  Metadata Repo      â”‚
     â”‚   (Object Storage)     â”‚   â”‚  (JPA/PostgreSQL)   â”‚
     â”‚                        â”‚   â”‚                     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                        â”‚
                    â†“                        â†“
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    AWS S3        â”‚    â”‚   PostgreSQL     â”‚
          â”‚   (Bucket)       â”‚    â”‚   (Database)     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Message Producer                               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                      â”‚         â”‚                  â”‚     â”‚
â”‚  â”‚  RabbitMQProducer    â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  MessageBuilder  â”‚     â”‚
â”‚  â”‚                      â”‚ <<uses>>â”‚                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚                                                 â”‚
â”‚           â”‚ publishes                                       â”‚
â”‚           â†“                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚  â”‚   RabbitMQ       â”‚                                       â”‚
â”‚  â”‚ medical_data     â”‚                                       â”‚
â”‚  â”‚   (Queue)        â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸:**
- AWS SDK (S3 Client)
- Spring AMQP (RabbitMQ)
- Spring Data JPA (PostgreSQL)

---

## Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸

- Â«Clean ArchitectureÂ» Robert Martin
- [AWS S3 Best Practices](https://docs.aws.amazon.com/AmazonS3/latest/userguide/best-practices.html)
- [RabbitMQ Patterns](https://www.rabbitmq.com/getstarted.html)

