# IDEF3 Диаграммы

## Описание методологии

IDEF3 (Process Description Capture Method) — методология описания процессов, фокусирующаяся на последовательности действий и временных связях между ними.

![IDEF3 Диаграмма](img/img2.png)

## Процессы системы (4 функции)

### P1: Регистрация пациента

**Описание:** Создание учётной записи и аутентификация

**Этапы:**
1. Пациент заполняет форму регистрации
2. Система валидирует данные
3. AuthController создаёт запись в PostgreSQL
4. Система отправляет письмо подтверждения
5. Пациент активирует аккаунт

**Компоненты:**
- React (интерфейс)
- Keycloak (аутентификация)
- PostgreSQL (хранение данных)

**Временные связи:**
- Последовательное выполнение
- Активация возможна только после подтверждения email

---

### P2: Загрузка данных

**Описание:** Приём и сохранение медицинских данных

**Этапы:**
1. Пациент выбирает файлы
2. Web-интерфейс отправляет POST запрос
3. API Gateway валидирует формат и размер
4. DataUploadController сохраняет в S3
5. Сообщение отправляется в RabbitMQ

**Компоненты:**
- Nginx (балансировка)
- API Gateway (валидация)
- AWS S3 (хранение)
- RabbitMQ (очередь)

**Временные связи:**
- P1 → P2: Регистрация обязательна для загрузки
- Параллельная загрузка изображений и текста

---

### P3: GPU-обработка

**Описание:** Анализ данных с использованием ИИ-моделей

**Этапы:**
1. ML Service получает сообщение из RabbitMQ
2. ImagePreprocessor обрабатывает изображение
3. BERTTokenizer обрабатывает текст
4. Параллельный запуск ResNet-50 и BERT
5. Агрегация результатов
6. Сохранение в Redis и PostgreSQL

**Компоненты:**
- TensorFlow Serving (inference)
- GPU кластер (вычисления)
- Redis (кэш)
- PostgreSQL (постоянное хранилище)

**Временные связи:**
- P2 → P3: Данные обрабатываются после валидации
- Параллельное выполнение анализа изображений и текста

---

### P4: Логирование и мониторинг

**Описание:** Сбор и анализ логов системы

**Этапы:**
1. Сервисы генерируют логи
2. Filebeat собирает логи
3. Logstash обрабатывает и фильтрует
4. Elasticsearch индексирует данные
5. Kibana визуализирует метрики

**Компоненты:**
- Filebeat (сбор логов)
- Logstash (обработка)
- Elasticsearch (хранение)
- Kibana (визуализация)

**Временные связи:**
- Непрерывное выполнение параллельно всем процессам
- Реакция на критические ошибки в реальном времени

---

## Особенности временных связей

- **Последовательность:** P1 → P2 → P3 (основной flow)
- **Параллельность:** P4 выполняется независимо
- **Синхронизация:** Результаты P3 доступны только после завершения обработки

