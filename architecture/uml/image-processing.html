<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Функция 3: Обработка изображений - system-engineering-playbook</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../src/_assets/custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">system-engineering-playbook</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="uml-РРёРРіСЂРРјРјС-РћРСЂРРРѕСРєР-РёРРѕРСЂРРРµРЅРёР"><a class="header" href="#uml-РРёРРіСЂРРјРјС-РћРСЂРРРѕСРєР-РёРРѕРСЂРРРµРЅРёР">UML Р”РёР°РіСЂР°РјРјС‹: РћР±СЂР°Р±РѕС‚РєР° РёР·РѕР±СЂР°Р¶РµРЅРёР№</a></h1>
<h2 id="РСѓРЅРєСРёСЏ-3-РћРСЂРРРѕСРєР-РјРµРґРёСРёРЅСЃРєРёС-РёРРѕРСЂРРРµРЅРёР-resnet-50"><a class="header" href="#РСѓРЅРєСРёСЏ-3-РћРСЂРРРѕСРєР-РјРµРґРёСРёРЅСЃРєРёС-РёРРѕРСЂРРРµРЅРёР-resnet-50">Р¤СѓРЅРєС†РёСЏ 3: РћР±СЂР°Р±РѕС‚РєР° РјРµРґРёС†РёРЅСЃРєРёС… РёР·РѕР±СЂР°Р¶РµРЅРёР№ (ResNet-50)</a></h2>
<h3 id="1-use-case-diagram-РРёРРіСЂРРјРјР-РІРСЂРёРРЅСРѕРІ-РёСЃРїРѕРСЊРРѕРІРРЅРёСЏ"><a class="header" href="#1-use-case-diagram-РРёРРіСЂРРјРјР-РІРСЂРёРРЅСРѕРІ-РёСЃРїРѕРСЊРРѕРІРРЅРёСЏ">1. Use Case Diagram (Р”РёР°РіСЂР°РјРјР° РІР°СЂРёР°РЅС‚РѕРІ РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ)</a></h3>
<p><strong>РђРєС‚С‘СЂС‹:</strong></p>
<ul>
<li><strong>ML Service</strong> (СЃРёСЃС‚РµРјР°)</li>
<li><strong>ML Engineer</strong> (РёРЅР¶РµРЅРµСЂ РјР°С€РёРЅРЅРѕРіРѕ РѕР±СѓС‡РµРЅРёСЏ)</li>
<li><strong>GPU Cluster</strong> (РёРЅС„СЂР°СЃС‚СЂСѓРєС‚СѓСЂР°)</li>
</ul>
<p><strong>Р’Р°СЂРёР°РЅС‚С‹ РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ:</strong></p>
<ol>
<li>
<p><strong>РџСЂРµРїСЂРѕС†РµСЃСЃРёРЅРі РёР·РѕР±СЂР°Р¶РµРЅРёСЏ</strong></p>
<ul>
<li>РџРµСЂРІРёС‡РЅС‹Р№ Р°РєС‚С‘СЂ: ML Service</li>
<li>РџСЂРµРґСѓСЃР»РѕРІРёСЏ: РР·РѕР±СЂР°Р¶РµРЅРёРµ Р·Р°РіСЂСѓР¶РµРЅРѕ РІ S3</li>
<li>РџРѕСЃС‚СѓСЃР»РѕРІРёСЏ: РўРµРЅР·РѕСЂ РіРѕС‚РѕРІ РґР»СЏ inference</li>
</ul>
</li>
<li>
<p><strong>РљР»Р°СЃСЃРёС„РёРєР°С†РёСЏ РёР·РѕР±СЂР°Р¶РµРЅРёСЏ (ResNet-50)</strong></p>
<ul>
<li>РџРµСЂРІРёС‡РЅС‹Р№ Р°РєС‚С‘СЂ: ML Service</li>
<li>РџСЂРµРґСѓСЃР»РѕРІРёСЏ: РўРµРЅР·РѕСЂ РїРѕРґРіРѕС‚РѕРІР»РµРЅ</li>
<li>РџРѕСЃС‚СѓСЃР»РѕРІРёСЏ: Р РµР·СѓР»СЊС‚Р°С‚С‹ РєР»Р°СЃСЃРёС„РёРєР°С†РёРё РїРѕР»СѓС‡РµРЅС‹</li>
</ul>
</li>
<li>
<p><strong>РћР±РЅРѕРІР»РµРЅРёРµ РјРѕРґРµР»Рё</strong></p>
<ul>
<li>РџРµСЂРІРёС‡РЅС‹Р№ Р°РєС‚С‘СЂ: ML Engineer</li>
<li>РџСЂРµРґСѓСЃР»РѕРІРёСЏ: РќРѕРІР°СЏ РІРµСЂСЃРёСЏ РјРѕРґРµР»Рё РѕР±СѓС‡РµРЅР°</li>
<li>РџРѕСЃС‚СѓСЃР»РѕРІРёСЏ: РњРѕРґРµР»СЊ СЂР°Р·РІС‘СЂРЅСѓС‚Р° РІ TensorFlow Serving</li>
</ul>
</li>
<li>
<p><strong>РњРѕРЅРёС‚РѕСЂРёРЅРі РїСЂРѕРёР·РІРѕРґРёС‚РµР»СЊРЅРѕСЃС‚Рё</strong></p>
<ul>
<li>РџРµСЂРІРёС‡РЅС‹Р№ Р°РєС‚С‘СЂ: ML Engineer</li>
<li>РЎРІСЏР·СЊ: <code>&lt;&lt;extend&gt;&gt;</code> РґР»СЏ РІСЃРµС… СЃС†РµРЅР°СЂРёРµРІ</li>
</ul>
</li>
</ol>
<p><strong>РЎРІСЏР·Рё:</strong></p>
<ul>
<li><code>&lt;&lt;include&gt;&gt;</code>: РљР»Р°СЃСЃРёС„РёРєР°С†РёСЏ РІРєР»СЋС‡Р°РµС‚ РїСЂРµРїСЂРѕС†РµСЃСЃРёРЅРі</li>
<li><code>&lt;&lt;extend&gt;&gt;</code>: РљСЌС€РёСЂРѕРІР°РЅРёРµ СЂР°СЃС€РёСЂСЏРµС‚ РєР»Р°СЃСЃРёС„РёРєР°С†РёСЋ</li>
</ul>
<hr />
<h3 id="2-activity-diagram-РРёРРіСЂРРјРјР-РРєСРёРІРЅРѕСЃСРµР"><a class="header" href="#2-activity-diagram-РРёРРіСЂРРјРјР-РРєСРёРІРЅРѕСЃСРµР">2. Activity Diagram (Р”РёР°РіСЂР°РјРјР° Р°РєС‚РёРІРЅРѕСЃС‚РµР№)</a></h3>
<pre><code>[РќР°С‡Р°Р»Рѕ: Message from RabbitMQ]
    в†“
[РџРѕР»СѓС‡РёС‚СЊ fileId РёР· СЃРѕРѕР±С‰РµРЅРёСЏ]
    в†“
[Р—Р°РіСЂСѓР·РёС‚СЊ РёР·РѕР±СЂР°Р¶РµРЅРёРµ РёР· S3]
    в†“
&lt;РР·РѕР±СЂР°Р¶РµРЅРёРµ РІ РєСЌС€Рµ?&gt; в—‡
    в”њв”Ђ Р”Р° в†’ [РџРѕР»СѓС‡РёС‚СЊ СЂРµР·СѓР»СЊС‚Р°С‚ РёР· Redis] в†’ [Р’РµСЂРЅСѓС‚СЊ СЂРµР·СѓР»СЊС‚Р°С‚] в†’ [РљРѕРЅРµС†]
    в””в”Ђ РќРµС‚ в†“
[Р”РµРєРѕРґРёСЂРѕРІР°РЅРёРµ РёР·РѕР±СЂР°Р¶РµРЅРёСЏ (OpenCV)]
    в†“
[РџСЂРѕРІРµСЂРєР° СЂР°Р·РјРµСЂРЅРѕСЃС‚Рё]
    в†“
&lt;Р Р°Р·РјРµСЂ РєРѕСЂСЂРµРєС‚РµРЅ?&gt; в—‡
    в”њв”Ђ РќРµС‚ в†’ [РР·РјРµРЅРёС‚СЊ СЂР°Р·РјРµСЂ РґРѕ 224x224]
    в””в”Ђ Р”Р° в†“
[РќРѕСЂРјР°Р»РёР·Р°С†РёСЏ РїРёРєСЃРµР»РµР№ (mean=[0.485, 0.456, 0.406])]
    в†“
[РџСЂРµРѕР±СЂР°Р·РѕРІР°РЅРёРµ РІ С‚РµРЅР·РѕСЂ (CHW format)]
    в†“
[Р”РѕР±Р°РІР»РµРЅРёРµ batch dimension]
    в†“
[РћС‚РїСЂР°РІРєР° РІ TensorFlow Serving (gRPC)]
    в†“
[РћР¶РёРґР°РЅРёРµ GPU inference (в‰¤2 СЃРµРє)]
    в†“
[РџРѕР»СѓС‡РµРЅРёРµ РІРµСЂРѕСЏС‚РЅРѕСЃС‚РµР№ (softmax)]
    в†“
[РџРѕСЃС‚РїСЂРѕС†РµСЃСЃРёРЅРі: РІС‹Р±РѕСЂ С‚РѕРї-3 РєР»Р°СЃСЃР°]
    в†“
[Р“РµРЅРµСЂР°С†РёСЏ heatmap (Grad-CAM)]
    в†“
в•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђ
    в•‘ РџР°СЂР°Р»Р»РµР»СЊРЅРѕРµ СЃРѕС…СЂР°РЅРµРЅРёРµ в•‘
в•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђ
    в•‘                          в•‘
    в•‘ [РЎРѕС…СЂР°РЅРµРЅРёРµ РІ Redis]     в•‘ [РЎРѕС…СЂР°РЅРµРЅРёРµ РІ PostgreSQL]
    в•‘  TTL = 1 С‡Р°СЃ             в•‘  + heatmap URL
    в•‘                          в•‘
в•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђв•ђ
    в†“
[РћС‚РїСЂР°РІРєР° СѓРІРµРґРѕРјР»РµРЅРёСЏ РІ WebSocket]
    в†“
[РљРѕРЅРµС†]
</code></pre>
<p><strong>РћСЃРѕР±РµРЅРЅРѕСЃС‚Рё:</strong></p>
<ul>
<li>РџР°СЂР°Р»Р»РµР»СЊРЅРѕРµ СЃРѕС…СЂР°РЅРµРЅРёРµ РґР»СЏ РѕРїС‚РёРјРёР·Р°С†РёРё</li>
<li>РљСЌС€РёСЂРѕРІР°РЅРёРµ РґР»СЏ РїРѕРІС‚РѕСЂРЅС‹С… Р·Р°РїСЂРѕСЃРѕРІ</li>
</ul>
<hr />
<h3 id="3-sequence-diagram-РРёРРіСЂРРјРјР-РїРѕСЃРРµРґРѕРІРСРµРСЊРЅРѕСЃСРё"><a class="header" href="#3-sequence-diagram-РРёРРіСЂРРјРјР-РїРѕСЃРРµРґРѕРІРСРµРСЊРЅРѕСЃСРё">3. Sequence Diagram (Р”РёР°РіСЂР°РјРјР° РїРѕСЃР»РµРґРѕРІР°С‚РµР»СЊРЅРѕСЃС‚Рё)</a></h3>
<p><strong>РЈС‡Р°СЃС‚РЅРёРєРё:</strong></p>
<ul>
<li>RabbitMQ</li>
<li>MLInferenceService</li>
<li>S3Client</li>
<li>ImagePreprocessor</li>
<li>TensorFlowServing</li>
<li>ResNetModel</li>
<li>GradCAM</li>
<li>Redis</li>
<li>PostgreSQL</li>
<li>WebSocketNotifier</li>
</ul>
<pre><code>RabbitMQ  MLService  S3Client  Preprocessor  TFServing  ResNet  GradCAM  Redis  PostgreSQL  WebSocket
   |          |         |           |            |         |        |       |        |          |
   |--msg----&gt;|         |           |            |         |        |       |        |          |
   |{fileId}  |         |           |            |         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--download(fileId)--&gt;|            |         |        |       |        |          |
   |          |         |--GET-----&gt;|            |         |        |       |        |          |
   |          |         |&lt;--bytes---|            |         |        |       |        |          |
   |          |&lt;--image-|           |            |         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--preprocess(image)--------------&gt;|         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |         |     [decode image]     |         |        |       |        |          |
   |          |         |     [resize 224x224]   |         |        |       |        |          |
   |          |         |     [normalize]        |         |        |       |        |          |
   |          |         |     [to_tensor]        |         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |&lt;--tensor-----------|            |         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--predict(tensor)---------------&gt;|         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |         |           |      [gRPC call]     |        |       |        |          |
   |          |         |           |            |--------&gt;|        |       |        |          |
   |          |         |           |            |  forward_pass   |       |        |          |
   |          |         |           |            |&lt;--------|        |       |        |          |
   |          |         |           |            |  logits |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |         |           |      [softmax]       |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |&lt;--probabilities-----|            |         |        |       |        |          |
   |          |  [0.95, 0.03, 0.02, ...]         |         |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--generate_heatmap(tensor, probabilities)-----------&gt;|       |        |          |
   |          |         |           |            |         |  Grad-CAM     |        |          |
   |          |&lt;--heatmap_image-----|            |         |&lt;-------|       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |         |           |   [Parallel save]    |        |       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--cache(results)-------------------------------&gt;|    |       |        |          |
   |          |         |           |            |         | SET    |       |        |          |
   |          |         |           |            |         |&lt;-------|       |        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--save(results, heatmap)-------------------------------&gt;|    |        |          |
   |          |         |           |            |         |        | INSERT|        |          |
   |          |         |           |            |         |        |&lt;------|        |          |
   |          |         |           |            |         |        |       |        |          |
   |          |--notify(userId, results)----------------------------------------&gt;|   |          |
   |          |         |           |            |         |        |       |        |---------&gt;|
   |          |         |           |            |         |        |       |        |  send    |
   |          |         |           |            |         |        |       |        |  message |
   |          |         |           |            |         |        |       |        |          |
   |&lt;--ACK----|         |           |            |         |        |       |        |          |
</code></pre>
<p><strong>РљР»СЋС‡РµРІС‹Рµ РјРѕРјРµРЅС‚С‹:</strong></p>
<ul>
<li>gRPC РґР»СЏ РІС‹СЃРѕРєРѕРїСЂРѕРёР·РІРѕРґРёС‚РµР»СЊРЅРѕРіРѕ inference</li>
<li>Grad-CAM РґР»СЏ РІРёР·СѓР°Р»РёР·Р°С†РёРё СЂРµС€РµРЅРёР№ РјРѕРґРµР»Рё</li>
<li>РџР°СЂР°Р»Р»РµР»СЊРЅРѕРµ СЃРѕС…СЂР°РЅРµРЅРёРµ РІ Redis Рё PostgreSQL</li>
</ul>
<hr />
<h3 id="4-class-diagram-РРёРРіСЂРРјРјР-РєРРСЃСЃРѕРІ"><a class="header" href="#4-class-diagram-РРёРРіСЂРРјРјР-РєРРСЃСЃРѕРІ">4. Class Diagram (Р”РёР°РіСЂР°РјРјР° РєР»Р°СЃСЃРѕРІ)</a></h3>
<pre><code>в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚   MLInferenceService            в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - messageConsumer: RabbitMQ     в”‚
в”‚ - preprocessor: ImagePreprocessorв”‚
в”‚ - tfClient: TensorFlowClient    в”‚
в”‚ - postprocessor: PostProcessor  в”‚
в”‚ - cacheService: CacheService    в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + processMessage(msg): void     в”‚
в”‚ + runInference(file): Result    в”‚
в”‚ + saveResults(result): void     в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
           в”‚ uses
           в†“
в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ         в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚   ImagePreprocessor             в”‚         в”‚   TensorFlowClient          в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤         в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - targetSize: (int, int)        в”‚         в”‚ - serverUrl: String         в”‚
в”‚ - mean: float[]                 в”‚         в”‚ - modelName: String         в”‚
в”‚ - std: float[]                  в”‚         в”‚ - channel: gRPCChannel      в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤         в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + decode(bytes): Image          в”‚         в”‚ + predict(tensor): Tensor   в”‚
в”‚ + resize(image): Image          в”‚         в”‚ + batchPredict(tensors): []  в”‚
в”‚ + normalize(image): Tensor      в”‚         в”‚ + getModelMetadata(): Meta  в”‚
в”‚ + preprocess(image): Tensor     в”‚         в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
           в”‚                                            в”‚
           в”‚ produces                                   в”‚ uses
           в†“                                            в†“
в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ         в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚       Tensor                    в”‚         в”‚   ResNetModel               в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤         в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - shape: int[]                  в”‚         в”‚ - inputShape: [1,224,224,3] в”‚
в”‚ - dtype: DataType               в”‚         в”‚ - numClasses: int           в”‚
в”‚ - data: ByteBuffer              в”‚         в”‚ - weights: String (path)    в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤         в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + reshape(shape): Tensor        в”‚         в”‚ + forward(tensor): Logits   в”‚
в”‚ + toArray(): float[]            в”‚         в”‚ + getLayer(name): Layer     в”‚
в”‚ + getShape(): int[]             в”‚         в”‚ + loadWeights(path): void   в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”         в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ         в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚    PostProcessor                в”‚         в”‚      GradCAM                в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤         в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - classLabels: Map&lt;int, String&gt; в”‚         в”‚ - model: ResNetModel        в”‚
в”‚ - threshold: float              в”‚         в”‚ - targetLayer: String       в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤         в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + softmax(logits): Probs        в”‚         в”‚ + generate(tensor, class): Imageв”‚
в”‚ + topK(probs, k): List          в”‚         в”‚ + computeGradients(): Tensorв”‚
в”‚ + formatResult(probs): Result   в”‚         в”‚ + applyColormap(heatmap): Imageв”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”         в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚   InferenceResult               в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - fileId: UUID                  в”‚
в”‚ - predictions: List&lt;Prediction&gt; в”‚
в”‚ - heatmapUrl: String            в”‚
в”‚ - inferenceTime: Duration       в”‚
в”‚ - timestamp: Timestamp          в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + getTopPrediction(): Predictionв”‚
в”‚ + toJSON(): String              в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚      Prediction                 в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - className: String             в”‚
в”‚ - probability: float            в”‚
в”‚ - confidence: float             в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + isHighConfidence(): boolean   в”‚
в”‚ + toString(): String            в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚    CacheService                 в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ - redisTemplate: RedisTemplate  в”‚
в”‚ - ttl: Duration                 в”‚
в”њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¤
в”‚ + get(key): Optional&lt;Result&gt;    в”‚
в”‚ + set(key, value, ttl): void    в”‚
в”‚ + invalidate(key): void         в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
</code></pre>
<p><strong>РџР°С‚С‚РµСЂРЅС‹:</strong></p>
<ul>
<li><strong>Strategy:</strong> ImagePreprocessor (СЂР°Р·РЅС‹Рµ СЃС‚СЂР°С‚РµРіРёРё РїСЂРµРїСЂРѕС†РµСЃСЃРёРЅРіР°)</li>
<li><strong>Factory:</strong> TensorFlowClient (СЃРѕР·РґР°РЅРёРµ gRPC РєР°РЅР°Р»РѕРІ)</li>
<li><strong>Repository:</strong> CacheService (Р°Р±СЃС‚СЂР°РєС†РёСЏ РЅР°Рґ Redis)</li>
</ul>
<hr />
<h3 id="5-state-diagram-РРёРРіСЂРРјРјР-СЃРѕСЃСРѕСЏРЅРёР"><a class="header" href="#5-state-diagram-РРёРРіСЂРРјРјР-СЃРѕСЃСРѕСЏРЅРёР">5. State Diagram (Р”РёР°РіСЂР°РјРјР° СЃРѕСЃС‚РѕСЏРЅРёР№)</a></h3>
<p><strong>РћР±СЉРµРєС‚:</strong> Image Inference Task</p>
<pre><code>          [Message received]
                 в†“
           в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
      в—Џв”Ђв”Ђв”Ђ&gt;в”‚  Queued  в”‚
           в”‚(Р’ РѕС‡РµСЂРµРґРё)в”‚
           в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                 в”‚ consumer picks up
                 в†“
           в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
           в”‚ Downloading  в”‚
           в”‚(Р—Р°РіСЂСѓР·РєР° РёР· S3)в”‚
           в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                 в”‚
            в”Њв”Ђв”Ђв”Ђв”Ђв”јв”Ђв”Ђв”Ђв”Ђв”ђ
            в”‚    в”‚    в”‚
    error   в”‚    в”‚    в”‚ success
        в”Њв”Ђв”Ђв”Ђв”    в”‚    в””в”Ђв”Ђв”Ђв”ђ
        в”‚        в”‚        в”‚
        в†“        в†“        в†“
   в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
   в”‚ Failed в”‚ в”‚Preprocessing в”‚
   в”‚(РћС€РёР±РєР°)в”‚ в”‚(РћР±СЂР°Р±РѕС‚РєР°)   в”‚
   в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв” в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
        в”‚           в”‚
        в”‚           в”‚ tensor ready
        в”‚           в†“
        в”‚     в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
        в”‚     в”‚  Inferencing в”‚
        в”‚     в”‚(GPU РѕР±СЂР°Р±РѕС‚РєР°)в”‚
        в”‚     в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
        в”‚           в”‚
        в”‚      в”Њв”Ђв”Ђв”Ђв”Ђв”јв”Ђв”Ђв”Ђв”Ђв”ђ
        в”‚      в”‚    в”‚    в”‚
        в”‚ GPU  в”‚    в”‚    в”‚ success
        в”‚ errorв”‚    в”‚    в”‚
        в”‚   в”Њв”Ђв”Ђв”    в”‚    в””в”Ђв”Ђв”ђ
        в”‚   в”‚       в”‚       в”‚
        в””в”Ђв”Ђв”Ђв–є       в†“       в†“
           в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
           в”‚PostProcessingв”‚ в”‚  Generating  в”‚
           в”‚(РџРѕСЃС‚-РѕР±СЂР°Р±РѕС‚РєР°)в”‚  Heatmap     в”‚
           в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв” в”‚(РЎРѕР·РґР°РЅРёРµ РєР°СЂС‚С‹)в”‚
                 в”‚          в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                 в”‚                в”‚
                 в”‚                в”‚
                 в†“                в†“
           в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
           в”‚   Caching    в”‚ в”‚   Saving     в”‚
           в”‚(РљСЌС€РёСЂРѕРІР°РЅРёРµ) в”‚ в”‚ (РЎРѕС…СЂР°РЅРµРЅРёРµ) в”‚
           в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв” в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                 в”‚                в”‚
                 в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”¬в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                          в†“
                    в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
                    в”‚Completed в”‚
                    в”‚(Р“РѕС‚РѕРІРѕ)  в”‚
                    в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                          в”‚
                          в†“
                          в—Џ
</code></pre>
<p><strong>РЎРѕСЃС‚РѕСЏРЅРёСЏ:</strong></p>
<ol>
<li><strong>Queued:</strong> Р—Р°РґР°С‡Р° РІ RabbitMQ</li>
<li><strong>Downloading:</strong> Р—Р°РіСЂСѓР·РєР° РёР·РѕР±СЂР°Р¶РµРЅРёСЏ РёР· S3</li>
<li><strong>Preprocessing:</strong> РџРѕРґРіРѕС‚РѕРІРєР° С‚РµРЅР·РѕСЂР°</li>
<li><strong>Inferencing:</strong> GPU inference (ResNet-50)</li>
<li><strong>PostProcessing:</strong> РћР±СЂР°Р±РѕС‚РєР° СЂРµР·СѓР»СЊС‚Р°С‚РѕРІ</li>
<li><strong>Generating Heatmap:</strong> Grad-CAM РІРёР·СѓР°Р»РёР·Р°С†РёСЏ</li>
<li><strong>Caching:</strong> РЎРѕС…СЂР°РЅРµРЅРёРµ РІ Redis</li>
<li><strong>Saving:</strong> РЎРѕС…СЂР°РЅРµРЅРёРµ РІ PostgreSQL</li>
<li><strong>Completed:</strong> Р—Р°РґР°С‡Р° Р·Р°РІРµСЂС€РµРЅР°</li>
<li><strong>Failed:</strong> РћС€РёР±РєР° РЅР° Р»СЋР±РѕРј СЌС‚Р°РїРµ</li>
</ol>
<p><strong>РџРµСЂРµС…РѕРґС‹ СЃ С‚Р°Р№РјР°СѓС‚Р°РјРё:</strong></p>
<ul>
<li>Downloading в†’ Failed (РµСЃР»Рё S3 РЅРµРґРѕСЃС‚СѓРїРµРЅ &gt; 30 СЃРµРє)</li>
<li>Inferencing в†’ Failed (РµСЃР»Рё GPU timeout &gt; 5 СЃРµРє)</li>
</ul>
<hr />
<h3 id="6-component-diagram-РРёРРіСЂРРјРјР-РєРѕРјРїРѕРЅРµРЅСРѕРІ"><a class="header" href="#6-component-diagram-РРёРРіСЂРРјРјР-РєРѕРјРїРѕРЅРµРЅСРѕРІ">6. Component Diagram (Р”РёР°РіСЂР°РјРјР° РєРѕРјРїРѕРЅРµРЅС‚РѕРІ)</a></h3>
<pre><code>в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚           ML Inference Service                              в”‚
в”‚                                                             в”‚
в”‚  в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ       в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ       в”‚
в”‚  в”‚                      в”‚       в”‚                  в”‚       в”‚
в”‚  в”‚  MessageConsumer     в”‚в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђ&gt;в”‚ InferenceOrchestrator   в”‚
в”‚  в”‚   (RabbitMQ)         в”‚triggers                  в”‚       в”‚
в”‚  в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”       в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”       в”‚
в”‚                                           в”‚                 в”‚
в”‚                                           в”‚ orchestrates    в”‚
в”‚                                           в†“                 в”‚
в”‚                         в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ    в”‚
в”‚                         в”‚  Pipeline Components        в”‚    в”‚
в”‚                         в”‚                              в”‚    в”‚
в”‚                         в”‚  - ImagePreprocessor         в”‚    в”‚
в”‚                         в”‚  - TensorFlowClient          в”‚    в”‚
в”‚                         в”‚  - PostProcessor             в”‚    в”‚
в”‚                         в”‚  - GradCAMGenerator          в”‚    в”‚
в”‚                         в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”    в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                    в”‚                        в”‚
                    в”‚ uses                   в”‚ uses
                    в†“                        в†“
     в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ   в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
     в”‚                        в”‚   в”‚                     в”‚
     в”‚  TensorFlow Serving    в”‚   в”‚   OpenCV Library    в”‚
     в”‚    (gRPC Server)       в”‚   в”‚   (C++ Backend)     в”‚
     в”‚                        в”‚   в”‚                     в”‚
     в”‚  - ResNet-50 Model     в”‚   в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
     в”‚  - Model Signature     в”‚
     в”‚  - GPU Support         в”‚
     в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
                    в”‚
                    в”‚ runs on
                    в†“
          в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
          в”‚   GPU Cluster    в”‚
          в”‚  (NVIDIA T4/A100)в”‚
          в”‚                  в”‚
          в”‚  - CUDA 11.x     в”‚
          в”‚  - cuDNN 8.x     в”‚
          в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚              Storage Components                             в”‚
в”‚                                                             в”‚
в”‚  в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ           в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ       в”‚
в”‚  в”‚                  в”‚           в”‚                  в”‚       в”‚
в”‚  в”‚  CacheService    в”‚           в”‚ ResultRepository в”‚       в”‚
в”‚  в”‚   (Redis)        в”‚           в”‚  (PostgreSQL)    в”‚       в”‚
в”‚  в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”           в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”       в”‚
в”‚         в”‚                               в”‚                   в”‚
в”‚         в”‚ stores                        в”‚ persists          в”‚
в”‚         в†“                               в†“                   в”‚
в”‚  в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ           в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ       в”‚
в”‚  в”‚  Redis Cluster   в”‚           в”‚  PostgreSQL DB   в”‚       в”‚
в”‚  в”‚  (In-memory)     в”‚           в”‚  (results table) в”‚       в”‚
в”‚  в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”           в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”       в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”

в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ
в”‚           Monitoring Components                             в”‚
в”‚                                                             в”‚
в”‚  в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ       в”Њв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”ђ       в”‚
в”‚  в”‚                      в”‚       в”‚                  в”‚       в”‚
в”‚  в”‚  MetricsCollector    в”‚в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђ&gt;в”‚  Prometheus      в”‚       в”‚
в”‚  в”‚                      в”‚exportsв”‚  (TSDB)          в”‚       в”‚
в”‚  в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”       в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”       в”‚
в”‚           в”‚                                                 в”‚
в”‚           в”‚ tracks                                          в”‚
в”‚           в”‚                                                 в”‚
в”‚           в”‚  - Inference time                               в”‚
в”‚           в”‚  - GPU utilization                              в”‚
в”‚           в”‚  - Throughput                                   в”‚
в”‚           в”‚  - Error rate                                   в”‚
в””в”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”Ђв”
</code></pre>
<p><strong>РРЅС‚РµСЂС„РµР№СЃС‹:</strong></p>
<ul>
<li><code>gRPC</code>: TensorFlow Serving API</li>
<li><code>AMQP</code>: RabbitMQ message protocol</li>
<li><code>Redis Protocol</code>: Cache communication</li>
<li><code>JDBC</code>: PostgreSQL connection</li>
</ul>
<hr />
<h2 id="РСЃСРѕСРЅРёРєРё"><a class="header" href="#РСЃСРѕСРЅРёРєРё">РСЃС‚РѕС‡РЅРёРєРё</a></h2>
<ul>
<li>В«Deep LearningВ» Ian Goodfellow</li>
<li><a href="https://arxiv.org/abs/1512.03385">ResNet Paper</a></li>
<li><a href="https://arxiv.org/abs/1610.02391">Grad-CAM</a></li>
<li><a href="https://www.tensorflow.org/tfx/guide/serving">TensorFlow Serving Guide</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../architecture/uml/data-upload.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../architecture/uml/text-analysis.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../architecture/uml/data-upload.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../architecture/uml/text-analysis.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
